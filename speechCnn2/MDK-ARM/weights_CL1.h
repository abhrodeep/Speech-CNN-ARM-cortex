#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include "arm_const_structs.h"
#include "arm_nnfunctions.h"


#define CONV1_IN_y 32
#define CONV1_IN_x 39
#define CONV1_IN_CH 1
#define CONV1_OUT_CH 12																		
#define CONV1_KER_y 3
#define CONV1_KER_x 3
#define CONV1_PAD_y 1
#define CONV1_PAD_x 1																		
#define CONV1_STRIDE_y 1
#define CONV1_STRIDE_x 1
#define CONV1_BIAS_LSHIFT 4
#define CONV1_OUT_RSHIFT 8
#define CONV1_OUT_y 32
#define CONV1_OUT_x 39

#define MAX1_IN_y 32
#define MAX1_IN_x 39
#define MAX1_OUT_y 16
#define MAX1_OUT_x 20
#define MAX1_STRIDE_y 2
#define MAX1_STRIDE_x 2
#define MAX1_KERNEL_y 3
#define MAX1_KERNEL_x 3
#define MAX1_PAD_y 0
#define MAX1_PAD_x 1
#define MAX1_ACT_min 0
#define MAX1_ACT_max 127
#define MAX1_CHANNEL_in 12


const q7_t b_1[CONV1_OUT_CH]={14,-7,6,6,1,-1,4,16,9,3,9,14};

const q7_t W_1[CONV1_IN_CH*CONV1_KER_y*CONV1_KER_x*CONV1_OUT_CH]={

-13,-8,-34,
10,-7,-7,
27,26,16,

18,-11,-16,
-7,9,-20,
-12,-6,-6,

-3,44,44,
-1,-18,-16,
12,-32,-19,

23,23,-17,
15,-5,-24,
-9,27,-20,

-3,-17,-4,
-14,9,31,
-18,19,54,

11,-8,7,
35,-22,-22,
14,25,-28,

-6,6,-5,
-29,-18,-7,
21,-28,13,

37,37,31,
23,1,35,
39,46,24,

11,-17,4,
-12,4,8,
-12,-9,-25,

-16,-29,-5,
-12,19,28,
-6,-5,36,

15,24,51,
53,69,49,
-8,46,48,

-25,18,-11,
-2,15,-23,
-10,-4,21





};

const float mean[CONV1_IN_CH*CONV1_IN_y*CONV1_IN_x] = { 
	
	-3.630757,-3.387984,-3.149552,-2.900005,-2.651444,-2.399563,-2.161630,-1.930992,-1.725947,-1.549910,-1.399275,-1.277017,-1.179212,-1.110143,-1.068574,-1.032242,-1.002149,-0.977781,-0.954155,-0.934965,-0.923044,-0.915781,-0.913735,-0.921096,-0.934570,-0.952988,-0.998435,-1.076611,-1.185826,-1.328956,-1.509242,-1.717782,-1.955030,-2.209052,-2.472999,-2.733418,-2.991793,-3.243694,-3.495552,
-3.648867,-3.404434,-3.162884,-2.909067,-2.655025,-2.397574,-2.153502,-1.916647,-1.705738,-1.522117,-1.361462,-1.233041,-1.126308,-1.046678,-0.996365,-0.951833,-0.913321,-0.882360,-0.852758,-0.830859,-0.814251,-0.806746,-0.806823,-0.817653,-0.834211,-0.858796,-0.910351,-0.996344,-1.114718,-1.264994,-1.452245,-1.669528,-1.913926,-2.175838,-2.448628,-2.714715,-2.977847,-3.234986,-3.491508,
-3.707373,-3.468524,-3.231915,-2.983651,-2.734443,-2.481124,-2.239906,-2.006588,-1.796312,-1.614590,-1.455239,-1.328003,-1.219288,-1.138009,-1.085808,-1.041709,-1.002610,-0.969857,-0.940689,-0.918844,-0.902704,-0.896043,-0.899387,-0.909039,-0.929922,-0.955292,-1.009550,-1.096786,-1.216217,-1.365909,-1.552851,-1.768047,-2.008470,-2.266172,-2.534094,-2.797605,-3.055404,-3.307901,-3.559673,
-3.750282,-3.513701,-3.280311,-3.034292,-2.787851,-2.536518,-2.296783,-2.065558,-1.857506,-1.675302,-1.512987,-1.383474,-1.272849,-1.190313,-1.135645,-1.089473,-1.046824,-1.011614,-0.983046,-0.960857,-0.947981,-0.942097,-0.945779,-0.958446,-0.981026,-1.012597,-1.066900,-1.157438,-1.280059,-1.430602,-1.616930,-1.832634,-2.072324,-2.328272,-2.595855,-2.857117,-3.112029,-3.362149,-3.609863,
-3.787987,-3.556550,-3.325852,-3.083782,-2.841612,-2.595798,-2.360190,-2.131426,-1.926189,-1.747747,-1.590748,-1.464532,-1.355742,-1.274944,-1.220398,-1.175168,-1.135907,-1.101006,-1.073115,-1.052839,-1.040433,-1.035702,-1.040586,-1.052426,-1.074908,-1.104511,-1.158774,-1.247258,-1.369401,-1.518503,-1.700299,-1.912432,-2.149100,-2.400700,-2.661916,-2.917936,-3.168835,-3.414323,-3.657379,
-3.815454,-3.586723,-3.360702,-3.123858,-2.885743,-2.644861,-2.412915,-2.188879,-1.985953,-1.813092,-1.658254,-1.534260,-1.429300,-1.351318,-1.299451,-1.255413,-1.219202,-1.188020,-1.162784,-1.142944,-1.128900,-1.126070,-1.130118,-1.142465,-1.167548,-1.196714,-1.250516,-1.335211,-1.455062,-1.599312,-1.778711,-1.985355,-2.217527,-2.465072,-2.720311,-2.971892,-3.218429,-3.458699,-3.697769,
-3.837972,-3.611934,-3.388518,-3.155086,-2.919202,-2.681456,-2.455182,-2.235021,-2.036887,-1.865121,-1.714113,-1.593375,-1.491435,-1.418028,-1.367741,-1.325949,-1.292644,-1.262670,-1.239110,-1.220940,-1.209086,-1.206191,-1.211300,-1.224259,-1.246544,-1.274401,-1.325531,-1.407827,-1.523521,-1.664943,-1.840681,-2.045784,-2.273031,-2.514597,-2.766334,-3.013631,-3.255777,-3.491467,-3.727435,
-3.858993,-3.634344,-3.414183,-3.184664,-2.952659,-2.718071,-2.495515,-2.278522,-2.083011,-1.915728,-1.766906,-1.648901,-1.549521,-1.478641,-1.430725,-1.390730,-1.357867,-1.331686,-1.308597,-1.291652,-1.280678,-1.279137,-1.284061,-1.296823,-1.319175,-1.345216,-1.394803,-1.475903,-1.588715,-1.728493,-1.901992,-2.102980,-2.326288,-2.564205,-2.811280,-3.055923,-3.293840,-3.527496,-3.758670,
-3.876412,-3.655014,-3.436539,-3.208602,-2.979093,-2.747273,-2.526297,-2.312060,-2.118819,-1.955263,-1.808101,-1.690488,-1.593623,-1.524088,-1.477640,-1.439830,-1.407574,-1.382487,-1.360619,-1.344499,-1.334406,-1.332927,-1.339511,-1.352327,-1.372059,-1.399500,-1.449009,-1.529324,-1.641104,-1.780031,-1.949255,-2.146702,-2.368214,-2.602881,-2.848208,-3.088532,-3.324682,-3.554495,-3.783521,
-3.891382,-3.671065,-3.454731,-3.228081,-3.000740,-2.770905,-2.549886,-2.339496,-2.148881,-1.985331,-1.838927,-1.725192,-1.629426,-1.560518,-1.513406,-1.476433,-1.446103,-1.420379,-1.398610,-1.381799,-1.372705,-1.374018,-1.380254,-1.392667,-1.414530,-1.440978,-1.490324,-1.568891,-1.680084,-1.818034,-1.985836,-2.183257,-2.401687,-2.634287,-2.876467,-3.115628,-3.348370,-3.575991,-3.803324,
-3.902441,-3.684255,-3.468026,-3.242009,-3.014542,-2.786381,-2.568636,-2.357081,-2.166858,-2.004469,-1.861135,-1.747864,-1.651490,-1.583629,-1.537387,-1.499647,-1.468631,-1.445107,-1.423339,-1.407073,-1.399377,-1.399909,-1.406207,-1.417638,-1.439237,-1.465762,-1.515143,-1.594990,-1.704659,-1.840261,-2.008297,-2.203094,-2.419991,-2.652881,-2.894862,-3.130141,-3.364030,-3.590375,-3.815967,
-3.912542,-3.695161,-3.479613,-3.255394,-3.030211,-2.802593,-2.584923,-2.373244,-2.184757,-2.022915,-1.878461,-1.765945,-1.669442,-1.602077,-1.555555,-1.518754,-1.487133,-1.462260,-1.440990,-1.425598,-1.416085,-1.414478,-1.420093,-1.433523,-1.455219,-1.481598,-1.530862,-1.610530,-1.719059,-1.856087,-2.022674,-2.215465,-2.432984,-2.665181,-2.906418,-3.143158,-3.374341,-3.600007,-3.824659,
-3.917919,-3.701289,-3.486532,-3.263597,-3.037371,-2.810061,-2.593350,-2.383911,-2.193603,-2.032343,-1.889959,-1.776610,-1.679912,-1.612399,-1.565310,-1.528102,-1.497200,-1.471492,-1.449961,-1.435604,-1.427363,-1.426178,-1.431583,-1.444062,-1.464363,-1.491596,-1.541799,-1.620820,-1.729339,-1.865719,-2.032134,-2.225363,-2.441366,-2.672403,-2.912637,-3.148412,-3.380695,-3.605679,-3.830280,
-3.922807,-3.706879,-3.494361,-3.271802,-3.047685,-2.820811,-2.604054,-2.394558,-2.205966,-2.044238,-1.902189,-1.789523,-1.693225,-1.625495,-1.580333,-1.543442,-1.511712,-1.485936,-1.466972,-1.452334,-1.442331,-1.441648,-1.447069,-1.458877,-1.479762,-1.507009,-1.557648,-1.638654,-1.747422,-1.882804,-2.048680,-2.242178,-2.455795,-2.685868,-2.925426,-3.158861,-3.389778,-3.614404,-3.838675,
-3.932522,-3.718194,-3.505692,-3.283971,-3.061574,-2.835454,-2.619644,-2.411243,-2.223242,-2.061378,-1.920845,-1.810170,-1.715636,-1.648633,-1.603129,-1.567238,-1.534576,-1.508887,-1.490293,-1.477870,-1.468538,-1.468020,-1.473325,-1.486690,-1.506342,-1.533600,-1.583440,-1.664038,-1.771976,-1.906979,-2.072645,-2.264944,-2.478472,-2.706716,-2.944062,-3.176445,-3.404979,-3.629393,-3.851404,
-3.944885,-3.731569,-3.520570,-3.299931,-3.077188,-2.853631,-2.639001,-2.431960,-2.246092,-2.085215,-1.944543,-1.833647,-1.741133,-1.675573,-1.629442,-1.595226,-1.563737,-1.538535,-1.518178,-1.504445,-1.497571,-1.496940,-1.502710,-1.515662,-1.535162,-1.562804,-1.613167,-1.692390,-1.798556,-1.934278,-2.098927,-2.290061,-2.503437,-2.729388,-2.965252,-3.194850,-3.421196,-3.644519,-3.865058,
-3.955670,-3.743120,-3.532736,-3.312895,-3.091835,-2.869528,-2.655373,-2.447905,-2.263393,-2.104784,-1.964767,-1.853420,-1.759021,-1.694139,-1.649132,-1.613842,-1.582832,-1.558277,-1.538231,-1.524209,-1.516503,-1.515367,-1.522417,-1.536886,-1.556831,-1.584019,-1.632628,-1.710704,-1.816770,-1.952219,-2.116310,-2.306858,-2.519192,-2.744796,-2.980259,-3.210335,-3.434620,-3.656860,-3.875487,
-3.964350,-3.753120,-3.542938,-3.324309,-3.104359,-2.881977,-2.668181,-2.462487,-2.277781,-2.119847,-1.980297,-1.869891,-1.776774,-1.711146,-1.667132,-1.630793,-1.600659,-1.576711,-1.557762,-1.542645,-1.533519,-1.534145,-1.542714,-1.556933,-1.577442,-1.602926,-1.652331,-1.731504,-1.837508,-1.969970,-2.133525,-2.324544,-2.534623,-2.759215,-2.993296,-3.222280,-3.447087,-3.666327,-3.885511,
-3.971797,-3.760703,-3.551463,-3.333174,-3.113463,-2.892440,-2.680872,-2.475783,-2.292319,-2.134215,-1.994048,-1.883946,-1.789809,-1.723979,-1.679545,-1.644483,-1.615702,-1.591473,-1.571820,-1.556569,-1.547180,-1.548959,-1.556276,-1.570406,-1.590642,-1.617274,-1.666062,-1.746546,-1.852568,-1.985925,-2.148791,-2.339242,-2.549118,-2.771504,-3.005387,-3.234019,-3.458330,-3.676404,-3.893945,
-3.980557,-3.770411,-3.561863,-3.344174,-3.124830,-2.905729,-2.695038,-2.488662,-2.304952,-2.148131,-2.009581,-1.901183,-1.807015,-1.741911,-1.696779,-1.661213,-1.632397,-1.607207,-1.587427,-1.573235,-1.566425,-1.567411,-1.574533,-1.589172,-1.610331,-1.637591,-1.686344,-1.765929,-1.871799,-2.004961,-2.167343,-2.356041,-2.564904,-2.787895,-3.020433,-3.247848,-3.470555,-3.688628,-3.904145,
-3.985992,-3.775892,-3.569135,-3.352100,-3.132089,-2.912505,-2.702998,-2.499698,-2.317141,-2.158333,-2.020418,-1.910950,-1.819209,-1.753725,-1.707946,-1.672831,-1.641465,-1.617228,-1.597813,-1.583653,-1.576591,-1.577738,-1.584696,-1.600704,-1.621166,-1.647491,-1.696729,-1.777343,-1.884572,-2.018474,-2.179846,-2.365012,-2.574046,-2.797845,-3.029437,-3.255523,-3.478339,-3.695599,-3.911640,
-3.992636,-3.782662,-3.576123,-3.361053,-3.141492,-2.923529,-2.712653,-2.510093,-2.328442,-2.171126,-2.034023,-1.925845,-1.834560,-1.768594,-1.725045,-1.689290,-1.659774,-1.634487,-1.615031,-1.601645,-1.593074,-1.595372,-1.602605,-1.618204,-1.640665,-1.666213,-1.714681,-1.794188,-1.901718,-2.032694,-2.193666,-2.380796,-2.588233,-2.811229,-3.042684,-3.267375,-3.488728,-3.704217,-3.919750,
-3.998101,-3.790150,-3.583813,-3.368205,-3.152038,-2.932341,-2.724081,-2.522015,-2.341838,-2.185743,-2.049502,-1.941329,-1.850241,-1.785241,-1.740074,-1.707097,-1.677613,-1.653877,-1.635280,-1.621278,-1.612771,-1.613248,-1.621587,-1.637213,-1.658976,-1.686198,-1.734247,-1.812240,-1.918893,-2.050174,-2.209684,-2.396024,-2.602401,-2.824104,-3.054617,-3.277412,-3.498298,-3.712913,-3.927108,
-4.004910,-3.798190,-3.592897,-3.377860,-3.161631,-2.943791,-2.736008,-2.535316,-2.355626,-2.201409,-2.064544,-1.959233,-1.868589,-1.805448,-1.760640,-1.727317,-1.699043,-1.676240,-1.657357,-1.643663,-1.635965,-1.637009,-1.644337,-1.658439,-1.679092,-1.705354,-1.754974,-1.831912,-1.936360,-2.066741,-2.226784,-2.411877,-2.618437,-2.838974,-3.067358,-3.290730,-3.509638,-3.723335,-3.935248,
-4.008090,-3.801324,-3.596693,-3.382117,-3.166749,-2.949386,-2.743131,-2.542408,-2.362729,-2.208425,-2.072633,-1.967827,-1.878531,-1.812389,-1.768277,-1.734991,-1.707813,-1.684811,-1.666389,-1.652274,-1.645376,-1.645781,-1.652442,-1.667352,-1.687786,-1.714057,-1.761415,-1.838014,-1.942956,-2.073436,-2.232488,-2.417618,-2.623386,-2.843623,-3.072152,-3.293928,-3.512803,-3.726679,-3.939193,
-4.011168,-3.804952,-3.601285,-3.387888,-3.171815,-2.954836,-2.748061,-2.548627,-2.370736,-2.217552,-2.082684,-1.976331,-1.886485,-1.821570,-1.777838,-1.745461,-1.718324,-1.695030,-1.677511,-1.663251,-1.656085,-1.657385,-1.665504,-1.679875,-1.701146,-1.725159,-1.773243,-1.850132,-1.953761,-2.084027,-2.242152,-2.427013,-2.631464,-2.850101,-3.077095,-3.299235,-3.517598,-3.730384,-3.943144,
-4.016164,-3.808954,-3.605379,-3.391898,-3.176414,-2.960753,-2.755704,-2.556012,-2.378043,-2.224271,-2.089058,-1.982935,-1.895252,-1.830102,-1.787209,-1.753633,-1.725625,-1.704039,-1.685906,-1.671855,-1.663484,-1.665926,-1.673076,-1.686874,-1.708329,-1.733594,-1.781942,-1.858593,-1.962229,-2.092973,-2.249188,-2.432586,-2.638419,-2.856339,-3.082735,-3.304204,-3.521327,-3.734162,-3.946383,
-4.021986,-3.816246,-3.612916,-3.400855,-3.186606,-2.970457,-2.766388,-2.568830,-2.392453,-2.239328,-2.104776,-1.999509,-1.911435,-1.848419,-1.805435,-1.770336,-1.743338,-1.720070,-1.702024,-1.688516,-1.682702,-1.683941,-1.690133,-1.705183,-1.724833,-1.749906,-1.796911,-1.873765,-1.977502,-2.108042,-2.264655,-2.448301,-2.650466,-2.867362,-3.094063,-3.315362,-3.531689,-3.743280,-3.954674,
-4.024965,-3.821581,-3.617990,-3.405869,-3.191802,-2.976487,-2.772413,-2.575600,-2.400241,-2.246796,-2.112304,-2.008198,-1.920990,-1.857194,-1.813907,-1.780836,-1.753230,-1.729616,-1.712037,-1.699466,-1.693351,-1.694599,-1.700291,-1.715319,-1.736111,-1.759644,-1.806292,-1.882363,-1.986125,-2.116516,-2.272269,-2.453412,-2.656543,-2.872209,-3.098187,-3.319437,-3.535459,-3.746903,-3.958134,
-4.029390,-3.825707,-3.623149,-3.411376,-3.198524,-2.984471,-2.780645,-2.584558,-2.408849,-2.256927,-2.124241,-2.018824,-1.931831,-1.868096,-1.825497,-1.794197,-1.767941,-1.744140,-1.726501,-1.714291,-1.706739,-1.707960,-1.715540,-1.729066,-1.750076,-1.774072,-1.820305,-1.895222,-2.000012,-2.126565,-2.281649,-2.463349,-2.665167,-2.880778,-3.105474,-3.326095,-3.542028,-3.752387,-3.962556,
-4.036045,-3.833055,-3.631119,-3.420514,-3.206639,-2.994210,-2.790250,-2.594022,-2.419383,-2.267442,-2.135057,-2.031079,-1.944638,-1.881001,-1.838333,-1.806931,-1.780373,-1.758407,-1.741093,-1.728464,-1.719795,-1.722350,-1.728719,-1.743230,-1.762599,-1.785957,-1.833168,-1.907710,-2.010467,-2.137449,-2.292300,-2.472021,-2.672395,-2.886790,-3.112740,-3.331821,-3.546750,-3.756845,-3.966688,
-4.052432,-3.851148,-3.650551,-3.441998,-3.231270,-3.020231,-2.819908,-2.626432,-2.451087,-2.301712,-2.170067,-2.069139,-1.982180,-1.918949,-1.879277,-1.846686,-1.820891,-1.799212,-1.782398,-1.769965,-1.763763,-1.766272,-1.772740,-1.785037,-1.803977,-1.827514,-1.871301,-1.945557,-2.047043,-2.173975,-2.326587,-2.505319,-2.704935,-2.916936,-3.139302,-3.355565,-3.569171,-3.777095,-3.985077

};



const char val[12]={0x00,0x12,0x19,0x18,0x79,0x78,0x02,0x30,0x24,0x40,0x41,0x09};
